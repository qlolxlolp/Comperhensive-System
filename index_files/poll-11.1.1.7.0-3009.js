AdfUIComponents.createComponentClass("AdfUIPoll",{componentType:"org.apache.myfaces.trinidad.Poll",propertyKeys:[{name:"immediate",type:"Boolean","default":!1,secured:!0},{name:"pollListener",type:"Object",secured:!0}],eventNames:["poll"]});
AdfUIComponents.createComponentClass("AdfRichPoll",{componentType:"oracle.adf.RichPoll",propertyKeys:[{name:"interval",type:"Number","default":5E3},{name:"timeout",type:"Number","default":6E5}],superclass:AdfUIPoll});
AdfRichUIPeer.createPeerClass(AdfRichUIPeer,"AdfDhtmlPollPeer");AdfDhtmlPollPeer.InitSubclass=function(){this._INTERVAL_ID="_afrInterval";AdfRichUIPeer.addComponentPropertyChanges(this,AdfRichPoll.INTERVAL)};AdfDhtmlPollPeer.prototype.initialize=function(a){AdfDhtmlPollPeer.superclass.initialize.call(this,a);AdfDhtmlPollPeer._setInterval(a);AdfPage.PAGE.__getPollHelper().registerPollComponent(a)};
AdfDhtmlPollPeer._clearInterval=function(a){if(a=a[AdfDhtmlPollPeer._INTERVAL_ID])this[AdfDhtmlPollPeer._INTERVAL_ID]=void 0,window.clearInterval(a)};AdfDhtmlPollPeer._setInterval=function(a){var b=a.getInterval();if(b>=0){var c=a.createCallback(this._queuePoll),b=window.setInterval(c,b);a[AdfDhtmlPollPeer._INTERVAL_ID]=b}};AdfDhtmlPollPeer.prototype.ComponentIntervalChanged=function(a){AdfDhtmlPollPeer._clearInterval(a);AdfDhtmlPollPeer._setInterval(a);return!0};
AdfDhtmlPollPeer.prototype.ComponentRemoved=function(a){AdfDhtmlPollPeer._clearInterval(a);AdfPage.PAGE.__getPollHelper().unregisterPollComponent(a);AdfDhtmlPollPeer.superclass.ComponentRemoved.call(this,a)};AdfDhtmlPollPeer._queuePoll=function(){AdfPage.PAGE.__getPollHelper().isPollingTimeout()||AdfPollEvent.queue(this)};
function AdfPollHelper(){this.Init()}AdfObject.createSubclass(AdfPollHelper);AdfPollHelper.prototype.registerPollComponent=function(a){AdfAssert.assertObject(a);this._componentIDsArray.push(a.getClientId())};AdfPollHelper.prototype.unregisterPollComponent=function(a){AdfAssert.assertObject(a);a=a.getClientId();AdfCollections.removeArrayValue(this._componentIDsArray,a);this._globalTimeoutInterval=this._calculatePollingTimeoutInterval(this._defaultTimeoutInterval)};
AdfPollHelper.prototype.isPollingTimeout=function(){return this._stopPollingFlag==!0};AdfPollHelper.prototype.initializePollingTimeout=function(a){AdfAssert.assertNumberOrNull(a);this._defaultTimeoutInterval=a;this._globalTimeoutInterval=this._calculatePollingTimeoutInterval(a);this._rescheduleOrScheduleTimerIfNeeded()};AdfPollHelper.InitClass=function(){};AdfPollHelper.prototype.Init=function(){AdfPollHelper.superclass.Init.call(this);this._componentIDsArray=[];this._globalTimeoutInterval=null};
AdfPollHelper.prototype._calculatePollingTimeoutInterval=function(a){for(var b=this._componentIDsArray,c=null,d=AdfPage.PAGE,e=0;e<b.length;e++){var f=d.findComponent(b[e]);f&&(f=f.getTimeout(),f!=a&&(c==null?c=f:f>c&&(c=f)))}c!=null&&(a=c);return a};AdfPollHelper.prototype._forcePollingComponentStop=function(){this._stopPollingFlag=!0;this._pollingCheckTimer=null;var a=AdfPage.PAGE;a.getComponentIdsUpdatedByPollEvent()!=null&&a.scheduleTimer(this,this._applyPollTimeoutStyle,null,500)};
AdfPollHelper.prototype._applyPollTimeoutStyle=function(){for(var a=AdfPage.PAGE.getComponentIdsUpdatedByPollEvent(),b=[],c=AdfAgent.AGENT,d=0;d<a.length;d++){var e=c.getElementById(a[d]);AdfDomUtils.addCSSClassName(e,"p_AFNoUpdate");var f=this._createPollingTimeoutLayerElement(e);b.push(f);e.parentNode.insertBefore(f,e)}this._timeoutLayers=b};
AdfPollHelper.prototype._createPollingTimeoutLayerElement=function(a){AdfAssert.assertDomElement(a);var b=AdfAgent.AGENT,c=AdfPage.PAGE.getDomDocument().createElement("div");c.className="p_AFNoUpdateBadge";var d=c.style,e=AdfDomUtils.getRelativePosition(a);d.top=e.y+"px";d.left=e.x+"px";d.width=a.offsetWidth+"px";d.height=a.offsetHeight+"px";d.position="absolute";d.visibility="visible";a=b.getComputedStyle(a);d.zIndex=a.zIndex=="auto"?1:a.zIndex+1;return c};
AdfPollHelper.prototype._removePollingTimeoutLayer=function(){var a=AdfPage.PAGE.getComponentIdsUpdatedByPollEvent(),b=this._timeoutLayers;if(b&&b.length){for(var c=0;c<b.length;c++){var d=b.pop();d.parentNode.removeChild(d)}b=AdfAgent.AGENT;for(c=0;c<a.length;c++)d=b.getElementById(a.pop()),AdfDomUtils.removeCSSClassName(d,"p_AFNoUpdate")}};
AdfPollHelper.prototype._resetPollingTimeoutHandler=function(a){if(!(this._globalTimeoutInterval==-1||a.type=="mouseover"||a.type=="mouseout"||a.type=="blur"||a.type=="focus")&&page.getTimeoutWarningWindowState()==AdfDhtmlPage.TimeoutWarningWindowStates.NONE)this._removePollingTimeoutLayer(),this._rescheduleOrScheduleTimerIfNeeded()};
AdfPollHelper.prototype._rescheduleOrScheduleTimerIfNeeded=function(){var a=AdfPage.PAGE;this._pollingCheckTimer!=null&&a.cancelTimer(this._pollingCheckTimer);this._pollingCheckTimer=null;if(this._globalTimeoutInterval!=-1)this._pollingCheckTimer=a.scheduleTimer(this,this._forcePollingComponentStop,null,this._globalTimeoutInterval);this._stopPollingFlag=!1};AdfPollHelper.prototype._isPollingTimeout=function(){return this._stopPollingFlag==!0};